import os
import sys
from shutil import copyfile


'''
Utility tool for merging output directories from Toil jobs

Example usage:

innovation_merge_directories \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg57b598e9-2310-4dce-a04f-bfc2b4172a16/tmpmFT7rX \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg294c024d-7aa7-4121-90fc-55f760faac23/tmp6z6Nal \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stgfe87eae6-0652-47bb-9336-c1d9919d3596/tmpWUoXFW \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg185bf540-db71-40b9-9270-19ded5251fe5/tmpCVDyZ1 \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg43247422-9ab0-4793-a670-a4773441cf16/tmpGMcWKr \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg7c344dbc-41ac-4016-82cd-c9a9c22219b6/tmprMZrTj \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stgbf3a80c5-5b60-4bb2-a7ad-7fe65271448d/tmpNs7rdG \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg60df1702-98bd-4a50-a3b1-1a357cb51770/tmpFL89Sv \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg6368032a-962b-4d20-b712-c3f101f00da5/tmpqDYMtU \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg6e7e68ca-e5a7-44ff-abeb-5e470d54c906/tmp9VlQtG \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg3e1e9c23-3738-40f6-8f3a-f5583675b593/tmp8enri9 \
    /ifs/work/bergerm1/Innovation/sandbox/ian/outputs--scatter--1-5-2018/tmpUHV0ZF/stg1326c082-77d6-4001-b575-2a02ecbe57bc/tmpm_R7Pe
'''
# Grab the directories to be merged (argv[0] == this script)
src_dirs = sys.argv[1:]

print("Input Dirs Total: {}".format(len(src_dirs)))
print(src_dirs)

# For each directory, copy all files to the output_dir
for input_dir in src_dirs:
    for input_file in os.listdir(input_dir):
        src = input_dir + '/' + input_file
        dst = './' + input_file
        print("copying " + src + " to " + dst)
        copyfile(src, dst)
